let t=null,S=!1,o=null,w=null;const g=e=>{const d=Math.floor(e/60),y=Math.floor(e%60).toString().padStart(2,"0");return`${d}:${y}`};function L(e){try{return new URL(e,location.origin).href}catch{return e}}function x(){const e=document.getElementById("audio-element"),d=document.getElementById("play-icon"),y=document.getElementById("mute-icon"),u=document.getElementById("seek-slider"),p=document.getElementById("current-time"),I=document.getElementById("duration"),f=document.getElementById("audio-loading"),m=document.getElementById("audio-control"),v=document.getElementById("audio-player-container"),U=document.querySelector(".footer > div"),k=document.querySelectorAll(".card-pay-buttons");function E(){if(typeof window.YT>"u"||!window.YT.Player){setTimeout(E,100);return}t=new window.YT.Player("youtube-player",{height:"0",width:"0",events:{onReady:M,onStateChange:A}})}function M(){console.log("YouTube player ready"),S=!0}function A(n){n.data===window.YT.PlayerState.PLAYING?(d.checked=!0,C(),c(null)):(n.data===window.YT.PlayerState.PAUSED||n.data===window.YT.PlayerState.ENDED)&&(d.checked=!1,P(),c(null))}function C(){P(),w=window.setInterval(()=>{if(t&&o==="youtube"){const n=t.getCurrentTime(),a=t.getDuration();n&&a&&(u.value=Math.floor(n).toString(),p.textContent=g(n),u.max=Math.floor(a).toString())}},100)}function P(){w&&(clearInterval(w),w=null)}typeof window.YT<"u"?E():window.onYouTubeIframeAPIReady=E,e.addEventListener("loadedmetadata",()=>{I.textContent=g(e.duration),u.max=Math.floor(e.duration).toString(),f?.classList.add("hidden"),m?.classList.remove("hidden")}),e.addEventListener("error",()=>{f?.classList.add("hidden"),m?.classList.add("hidden")}),d?.addEventListener("change",()=>{o==="youtube"&&t?t.getPlayerState()===window.YT.PlayerState.PLAYING?t.pauseVideo():t.playVideo():o==="audio"&&(e.paused?e.play():e.pause())}),e.addEventListener("play",()=>{d.checked=!0,c(null)}),e.addEventListener("pause",()=>{d.checked=!1,c(null)}),y?.addEventListener("change",()=>{o==="youtube"&&t?y.checked?t.mute():t.unMute():e.muted=y.checked}),u?.addEventListener("input",()=>{p.textContent=g(parseInt(u.value))}),u?.addEventListener("change",()=>{o==="youtube"&&t?t.seekTo(parseInt(u.value),!0):e.currentTime=parseInt(u.value)}),e.addEventListener("timeupdate",()=>{o==="audio"&&(u.value=Math.floor(e.currentTime).toString(),p.textContent=g(e.currentTime))}),k.forEach(n=>{n.addEventListener("click",()=>{if(!(n instanceof HTMLInputElement))return;const a=n.dataset.audioUrl,i=n.dataset.youtubeId;if(!(!a&&!i)){if(v?.classList.remove("hidden","opacity-0"),v?.classList.add("flex"),U?.classList.add("pb-24"),setTimeout(()=>v?.classList.remove("opacity-0"),100),i){if(!S){console.log("YouTube player not ready yet, waiting...");const s=window.setInterval(()=>{S&&(clearInterval(s),n.click())},100);return}const r=t.getVideoUrl(),l=r&&r.includes(i);if(console.log("YouTube button clicked:",{youtubeId:i,currentVideoUrl:r,isSameVideo:l,currentPlayerType:o,playerState:t.getPlayerState()}),l&&o==="youtube"){const s=t.getPlayerState();console.log("Toggling play/pause, current state:",s),s===window.YT.PlayerState.PLAYING?t.pauseVideo():t.playVideo();return}e.pause(),e.src="",f?.classList.remove("hidden"),m?.classList.add("hidden"),o="youtube",t.loadVideoById(i),t.playVideo();const h=window.setInterval(()=>{const s=t.getDuration();s>0&&(I.textContent=g(s),u.max=Math.floor(s).toString(),f?.classList.add("hidden"),m?.classList.remove("hidden"),clearInterval(h))},100);d.checked=!0,c(n.id)}else if(a){o="audio",P(),t&&t.stopVideo();const r=a.startsWith("http")?a:encodeURI(a),l=L(r);if(L(e.src)===l){e.paused?e.play():e.pause();return}f?.classList.remove("hidden"),m?.classList.add("hidden"),p.textContent="0:00",I.textContent="0:00",e.src=l,e.load(),d.checked=!0,c(n.id),e.play()}}})});function c(n){k.forEach(a=>{if(!(a instanceof HTMLInputElement))return;const i=a.dataset.audioUrl,r=a.dataset.youtubeId;if(!i&&!r)return;let l=!1;if(o==="youtube"&&r&&t){const T=t.getVideoUrl();l=T?T.includes(r):!1}else if(o==="audio"&&i){const T=L(i);l=L(e.src)===T}const h=a.id===n,b=(o==="youtube"?t&&t.getPlayerState()===window.YT.PlayerState.PLAYING:!e.paused)&&l&&(h||n===null);a.checked=b;const Y=a.closest(".audio-card");Y&&(Y.dataset.active=b?"true":"false")})}document.addEventListener("keydown",n=>{const a=document.activeElement;if(!(a&&["INPUT","TEXTAREA"].includes(a.tagName))&&!n.altKey)switch(n.code){case"Space":n.preventDefault(),d?.click();break;case"ArrowRight":if(n.preventDefault(),o==="youtube"&&t){const i=t.getCurrentTime(),r=t.getDuration();t.seekTo(Math.min(r,i+5),!0)}else e.currentTime=Math.min(e.duration,e.currentTime+5);break;case"ArrowLeft":if(n.preventDefault(),o==="youtube"&&t){const i=t.getCurrentTime();t.seekTo(Math.max(0,i-5),!0)}else e.currentTime=Math.max(0,e.currentTime-5);break}})}document.addEventListener("DOMContentLoaded",()=>{x()});
