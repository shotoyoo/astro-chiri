let n=null,w=!1,u=null,S=null,e=null,i=null,f=null,r=null,c=null,y=null,h=null,T=null,v=null,G=null,b=!1;const Y="playerAudio",M="playerPlayToggle",C="playerMuteToggle",x="playerSeekSlider",N="playerBound",_="playerLabelBound",B="waitingForYoutube",I=t=>{const a=Math.floor(t/60),o=Math.floor(t%60).toString().padStart(2,"0");return`${a}:${o}`};function k(t){try{return new URL(t,location.origin).href}catch{return t}}function R(){return Array.from(document.querySelectorAll("input.card-pay-buttons"))}function H(){v?.classList.remove("hidden","opacity-0"),v?.classList.add("flex"),G?.classList.add("pb-24"),window.setTimeout(()=>v?.classList.remove("opacity-0"),100)}function O(){P(),S=window.setInterval(()=>{if(n&&u==="youtube"&&r&&c){const t=n.getCurrentTime(),a=n.getDuration();typeof t=="number"&&typeof a=="number"&&(r.value=Math.floor(t).toString(),c.textContent=I(t),r.max=Math.floor(a).toString())}},100)}function P(){S&&(clearInterval(S),S=null)}function g(t){R().forEach(o=>{if(!(o instanceof HTMLInputElement))return;const l=o.dataset.audioUrl,m=o.dataset.youtubeId;if(!l&&!m)return;let E=!1;if(u==="youtube"&&m&&n)try{const s=n.getVideoUrl();E=s?s.includes(m):!1}catch{E=!1}else if(u==="audio"&&l&&e){const s=k(l);E=k(e.src)===s}const p=o.id===t,A=u==="youtube"?!!(n&&n.getPlayerState()===window.YT.PlayerState.PLAYING):!!(e&&!e.paused),L=p||A&&E&&t===null;o.checked=L;const d=o.closest(".audio-card");d instanceof HTMLElement&&(d.dataset.active=L?"true":"false")})}function K(t){if((!e||!i)&&D(),!e||!i)return;const a=t.dataset.audioUrl??"",o=t.dataset.youtubeId??"",l=!!o,m=!!a;if(!l&&!m)return;const E=m&&!a.startsWith("http")?encodeURI(a):a,p=m?k(E):null,A=u==="youtube"&&o&&n&&(()=>{try{const d=n.getVideoUrl();return d?d.includes(o):!1}catch{return!1}})(),L=u==="audio"&&p&&e&&k(e.src)===p;if(A||L){A&&n?n.getPlayerState()===window.YT.PlayerState.PLAYING?(n.pauseVideo(),t.checked=!1):(n.playVideo(),t.checked=!0):L&&e&&(e.paused?(e.play(),t.checked=!0):(e.pause(),t.checked=!1));return}if(H(),l){if(!w){if(t.dataset[B]!=="true"){t.dataset[B]="true";const s=window.setInterval(()=>{w&&(clearInterval(s),delete t.dataset[B],t.click())},100)}return}if(u="youtube",P(),e.pause(),e.src="",h?.classList.remove("hidden"),T?.classList.add("hidden"),!n)return;n.loadVideoById(o),n.playVideo();const d=window.setInterval(()=>{if(!r||!y){clearInterval(d);return}try{const s=n.getDuration();s>0&&(y.textContent=I(s),r.max=Math.floor(s).toString(),h?.classList.add("hidden"),T?.classList.remove("hidden"),clearInterval(d))}catch{clearInterval(d)}},100);i.checked=!0,t.checked=!0,g(t.id),O()}else p&&(u="audio",P(),n&&n.stopVideo(),h?.classList.remove("hidden"),T?.classList.add("hidden"),c&&(c.textContent="0:00"),y&&(y.textContent="0:00"),e.src=p,e.load(),i.checked=!0,t.checked=!0,g(t.id),e.play().catch(()=>{t.checked=!1,u=null,h?.classList.add("hidden"),T?.classList.remove("hidden")}))}function q(){b||(document.addEventListener("keydown",te),b=!0)}function z(){R().forEach(a=>{if(!(a instanceof HTMLInputElement))return;a.dataset[N]!=="true"&&(a.dataset[N]="true");const o=a.closest("label");!o||o.dataset[_]==="true"||(o.addEventListener("click",l=>{l.preventDefault(),K(a)}),o.dataset[_]="true")})}function F(){!e||!r||!y||(y.textContent=I(e.duration),r.max=Math.floor(e.duration).toString(),h?.classList.add("hidden"),T?.classList.remove("hidden"))}function W(){h?.classList.add("hidden"),T?.classList.add("hidden")}function $(){i&&(u==="youtube"&&n?n.getPlayerState()===window.YT.PlayerState.PLAYING?n.pauseVideo():n.playVideo():u==="audio"&&e&&(e.paused?e.play():e.pause()))}function X(){i&&(i.checked=!0),g(null)}function j(){i&&(i.checked=!1),g(null)}function J(){f&&(u==="youtube"&&n?f.checked?n.mute():n.unMute():e&&(e.muted=f.checked))}function Q(){!r||!c||(c.textContent=I(parseInt(r.value,10)))}function Z(){if(!r)return;const t=parseInt(r.value,10);Number.isNaN(t)||(u==="youtube"&&n?n.seekTo(t,!0):e&&(e.currentTime=t))}function ee(){u!=="audio"||!e||!r||!c||(r.value=Math.floor(e.currentTime).toString(),c.textContent=I(e.currentTime))}function te(t){const a=document.activeElement;if(!(a&&["INPUT","TEXTAREA"].includes(a.tagName))&&!t.altKey)switch(t.code){case"Space":t.preventDefault(),i?.click();break;case"ArrowRight":if(t.preventDefault(),u==="youtube"&&n){const o=n.getCurrentTime(),l=n.getDuration();n.seekTo(Math.min(l,o+5),!0)}else e&&(e.currentTime=Math.min(e.duration,e.currentTime+5));break;case"ArrowLeft":if(t.preventDefault(),u==="youtube"&&n){const o=n.getCurrentTime();n.seekTo(Math.max(0,o-5),!0)}else e&&(e.currentTime=Math.max(0,e.currentTime-5));break}}function U(){const t=document.getElementById("youtube-player");if(!t){if(w=!1,n){try{n.destroy()}catch{}n=null}return}if(typeof window.YT>"u"||!window.YT.Player){window.setTimeout(U,100);return}if(n){try{const a=n.getIframe?.();if(a&&a.isConnected&&a.parentElement===t)return;n.destroy()}catch{}n=null,w=!1}n=new window.YT.Player(t,{height:"0",width:"0",events:{onReady:()=>{w=!0},onStateChange:a=>{a.data===window.YT.PlayerState.PLAYING?(i&&(i.checked=!0),O(),g(null)):(a.data===window.YT.PlayerState.PAUSED||a.data===window.YT.PlayerState.ENDED)&&(i&&(i.checked=!1),P(),g(null))}}})}function ne(){e&&!e.dataset[Y]&&(e.addEventListener("loadedmetadata",F),e.addEventListener("error",W),e.addEventListener("play",X),e.addEventListener("pause",j),e.addEventListener("timeupdate",ee),e.dataset[Y]="true"),i&&!i.dataset[M]&&(i.addEventListener("change",$),i.dataset[M]="true"),f&&!f.dataset[C]&&(f.addEventListener("change",J),f.dataset[C]="true"),r&&!r.dataset[x]&&(r.addEventListener("input",Q),r.addEventListener("change",Z),r.dataset[x]="true"),z(),q()}function D(){e=document.getElementById("audio-element"),i=document.getElementById("play-icon"),f=document.getElementById("mute-icon"),r=document.getElementById("seek-slider"),c=document.getElementById("current-time"),y=document.getElementById("duration"),h=document.getElementById("audio-loading"),T=document.getElementById("audio-control"),v=document.getElementById("audio-player-container"),G=document.querySelector(".footer > div"),!(!e||!i||!f||!r||!c||!y)&&(ne(),typeof window.YT<"u"?U():window.onYouTubeIframeAPIReady=U)}const V=()=>D();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",V,{once:!0}):V();document.addEventListener("astro:page-load",()=>{D()});window.addEventListener("pageshow",()=>{D()});
