let a=null,M=!1,n=null,E=null;const L=e=>{const r=Math.floor(e/60),p=Math.floor(e%60).toString().padStart(2,"0");return`${r}:${p}`};function k(e){try{return new URL(e,location.origin).href}catch{return e}}function x(){const e=document.getElementById("audio-element"),r=document.getElementById("play-icon"),p=document.getElementById("mute-icon"),d=document.getElementById("seek-slider"),v=document.getElementById("current-time"),P=document.getElementById("duration"),c=document.getElementById("audio-loading"),f=document.getElementById("audio-control"),S=document.getElementById("audio-player-container"),C=document.querySelector(".footer > div"),A=document.querySelectorAll(".card-pay-buttons");function Y(){if(typeof window.YT>"u"||!window.YT.Player){setTimeout(Y,100);return}a=new window.YT.Player("youtube-player",{height:"0",width:"0",events:{onReady:D,onStateChange:b}})}function D(){console.log("YouTube player ready"),M=!0}function b(t){t.data===window.YT.PlayerState.PLAYING?(r.checked=!0,B(),y(null)):(t.data===window.YT.PlayerState.PAUSED||t.data===window.YT.PlayerState.ENDED)&&(r.checked=!1,I(),y(null))}function B(){I(),E=window.setInterval(()=>{if(a&&n==="youtube"){const t=a.getCurrentTime(),o=a.getDuration();t&&o&&(d.value=Math.floor(t).toString(),v.textContent=L(t),d.max=Math.floor(o).toString())}},100)}function I(){E&&(clearInterval(E),E=null)}typeof window.YT<"u"?Y():window.onYouTubeIframeAPIReady=Y,e.addEventListener("loadedmetadata",()=>{P.textContent=L(e.duration),d.max=Math.floor(e.duration).toString(),c?.classList.add("hidden"),f?.classList.remove("hidden")}),e.addEventListener("error",()=>{c?.classList.add("hidden"),f?.classList.add("hidden")}),r?.addEventListener("change",()=>{n==="youtube"&&a?a.getPlayerState()===window.YT.PlayerState.PLAYING?a.pauseVideo():a.playVideo():n==="audio"&&(e.paused?e.play():e.pause())}),e.addEventListener("play",()=>{r.checked=!0,y(null)}),e.addEventListener("pause",()=>{r.checked=!1,y(null)}),p?.addEventListener("change",()=>{n==="youtube"&&a?p.checked?a.mute():a.unMute():e.muted=p.checked}),d?.addEventListener("input",()=>{v.textContent=L(parseInt(d.value))}),d?.addEventListener("change",()=>{n==="youtube"&&a?a.seekTo(parseInt(d.value),!0):e.currentTime=parseInt(d.value)}),e.addEventListener("timeupdate",()=>{n==="audio"&&(d.value=Math.floor(e.currentTime).toString(),v.textContent=L(e.currentTime))}),A.forEach(t=>{t.addEventListener("click",o=>{if(o.preventDefault(),!(t instanceof HTMLInputElement))return;const i=t.dataset.audioUrl??"",u=t.dataset.youtubeId??"",m=!!u,g=!!i;if(!m&&!g)return;const U=g&&!i.startsWith("http")?encodeURI(i):i,s=g?k(U):null,T=n==="youtube"&&u&&a&&(()=>{try{const h=a.getVideoUrl();return h?h.includes(u):!1}catch{return!1}})(),l=n==="audio"&&s&&k(e.src)===s;if(T||l){T&&a?a.getPlayerState()===window.YT.PlayerState.PLAYING?(a.pauseVideo(),t.checked=!1):(a.playVideo(),t.checked=!0):l&&(e.paused?(e.play(),t.checked=!0):(e.pause(),t.checked=!1));return}if(S?.classList.remove("hidden","opacity-0"),S?.classList.add("flex"),C?.classList.add("pb-24"),setTimeout(()=>S?.classList.remove("opacity-0"),100),m){if(!M){if(t.dataset.waitingForYoutube!=="true"){t.dataset.waitingForYoutube="true";const w=window.setInterval(()=>{M&&(clearInterval(w),delete t.dataset.waitingForYoutube,t.click())},100)}return}n="youtube",I(),e.pause(),e.src="",c?.classList.remove("hidden"),f?.classList.add("hidden"),a.loadVideoById(u),a.playVideo();const h=window.setInterval(()=>{try{const w=a.getDuration();w>0&&(P.textContent=L(w),d.max=Math.floor(w).toString(),c?.classList.add("hidden"),f?.classList.remove("hidden"),clearInterval(h))}catch{clearInterval(h)}},100);r.checked=!0,t.checked=!0,y(t.id),B()}else s&&(n="audio",I(),a&&a.stopVideo(),c?.classList.remove("hidden"),f?.classList.add("hidden"),v.textContent="0:00",P.textContent="0:00",e.src=s,e.load(),r.checked=!0,t.checked=!0,y(t.id),e.play().catch(()=>{t.checked=!1,n=null,c?.classList.add("hidden"),f?.classList.remove("hidden")}))})});function y(t){A.forEach(o=>{if(!(o instanceof HTMLInputElement))return;const i=o.dataset.audioUrl,u=o.dataset.youtubeId;if(!i&&!u)return;let m=!1;if(n==="youtube"&&u&&a){const l=a.getVideoUrl();m=l?l.includes(u):!1}else if(n==="audio"&&i){const l=k(i);m=k(e.src)===l}const g=o.id===t,U=n==="youtube"?a&&a.getPlayerState()===window.YT.PlayerState.PLAYING:!e.paused,s=g||U&&m&&t===null;o.checked=s;const T=o.closest(".audio-card");T&&(T.dataset.active=s?"true":"false")})}document.addEventListener("keydown",t=>{const o=document.activeElement;if(!(o&&["INPUT","TEXTAREA"].includes(o.tagName))&&!t.altKey)switch(t.code){case"Space":t.preventDefault(),r?.click();break;case"ArrowRight":if(t.preventDefault(),n==="youtube"&&a){const i=a.getCurrentTime(),u=a.getDuration();a.seekTo(Math.min(u,i+5),!0)}else e.currentTime=Math.min(e.duration,e.currentTime+5);break;case"ArrowLeft":if(t.preventDefault(),n==="youtube"&&a){const i=a.getCurrentTime();a.seekTo(Math.max(0,i-5),!0)}else e.currentTime=Math.max(0,e.currentTime-5);break}})}document.addEventListener("DOMContentLoaded",()=>{x()});
