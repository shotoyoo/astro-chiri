let t=null,P=!1,r=null,L=null;const p=e=>{const l=Math.floor(e/60),h=Math.floor(e%60).toString().padStart(2,"0");return`${l}:${h}`};function k(e){try{return new URL(e,location.origin).href}catch{return e}}function b(){const e=document.getElementById("audio-element"),l=document.getElementById("play-icon"),h=document.getElementById("mute-icon"),d=document.getElementById("seek-slider"),v=document.getElementById("current-time"),S=document.getElementById("duration"),g=document.getElementById("audio-loading"),w=document.getElementById("audio-control"),E=document.getElementById("audio-player-container"),Y=document.querySelector(".footer > div"),M=document.querySelectorAll(".card-pay-buttons");function I(){if(typeof window.YT>"u"||!window.YT.Player){setTimeout(I,100);return}t=new window.YT.Player("youtube-player",{height:"0",width:"0",events:{onReady:C,onStateChange:U}})}function C(){console.log("YouTube player ready"),P=!0}function U(n){n.data===window.YT.PlayerState.PLAYING?(l.checked=!0,B(),f(null)):(n.data===window.YT.PlayerState.PAUSED||n.data===window.YT.PlayerState.ENDED)&&(l.checked=!1,x(),f(null))}function B(){x(),L=window.setInterval(()=>{if(t&&r==="youtube"){const n=t.getCurrentTime(),o=t.getDuration();n&&o&&(d.value=Math.floor(n).toString(),v.textContent=p(n),d.max=Math.floor(o).toString())}},100)}function x(){L&&(clearInterval(L),L=null)}typeof window.YT<"u"?I():window.onYouTubeIframeAPIReady=I,e.addEventListener("loadedmetadata",()=>{S.textContent=p(e.duration),d.max=Math.floor(e.duration).toString(),g?.classList.add("hidden"),w?.classList.remove("hidden")}),e.addEventListener("error",()=>{g?.classList.add("hidden"),w?.classList.add("hidden")}),l?.addEventListener("change",()=>{r==="youtube"&&t?t.getPlayerState()===window.YT.PlayerState.PLAYING?t.pauseVideo():t.playVideo():r==="audio"&&(e.paused?e.play():e.pause())}),e.addEventListener("play",()=>{l.checked=!0,f(null)}),e.addEventListener("pause",()=>{l.checked=!1,f(null)}),h?.addEventListener("change",()=>{r==="youtube"&&t?h.checked?t.mute():t.unMute():e.muted=h.checked}),d?.addEventListener("input",()=>{v.textContent=p(parseInt(d.value))}),d?.addEventListener("change",()=>{r==="youtube"&&t?t.seekTo(parseInt(d.value),!0):e.currentTime=parseInt(d.value)}),e.addEventListener("timeupdate",()=>{r==="audio"&&(d.value=Math.floor(e.currentTime).toString(),v.textContent=p(e.currentTime))}),M.forEach(n=>{n.addEventListener("click",()=>{if(!(n instanceof HTMLElement))return;f(n.id);var o=n.querySelector(".play-pause-icon");if(o&&(o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><rect x="6" y="4" width="4" height="16" stroke-width="2"></rect><rect x="14" y="4" width="4" height="16" stroke-width="2"></rect></svg>'),!(n instanceof HTMLElement))return;const i=n.querySelector(".play-pause-icon");if(i&&(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><rect x="6" y="4" width="4" height="16" stroke-width="2"></rect><rect x="14" y="4" width="4" height="16" stroke-width="2"></rect></svg>'),!(n instanceof HTMLElement))return;const a=n.dataset.audioUrl,u=n.dataset.youtubeId;if(!(!a&&!u)){if(E?.classList.remove("hidden","opacity-0"),E?.classList.add("flex"),Y?.classList.add("pb-24"),setTimeout(()=>E?.classList.remove("opacity-0"),100),u){if(!P){console.log("YouTube player not ready yet, waiting...");const s=window.setInterval(()=>{P&&(clearInterval(s),n.click())},100);return}const c=t.getVideoUrl(),y=c&&c.includes(u);if(console.log("YouTube button clicked:",{youtubeId:u,currentVideoUrl:c,isSameVideo:y,currentPlayerType:r,playerState:t.getPlayerState()}),y&&r==="youtube"){const s=t.getPlayerState();console.log("Toggling play/pause, current state:",s),s===window.YT.PlayerState.PLAYING?t.pauseVideo():t.playVideo();return}e.pause(),e.src="",g?.classList.remove("hidden"),w?.classList.add("hidden"),r="youtube",t.loadVideoById(u),t.playVideo();const m=window.setInterval(()=>{const s=t.getDuration();s>0&&(S.textContent=p(s),d.max=Math.floor(s).toString(),g?.classList.add("hidden"),w?.classList.remove("hidden"),clearInterval(m))},100);l.checked=!0,f(n.id)}else if(a){r="audio",x(),t&&t.stopVideo();const c=a.startsWith("http")?a:encodeURI(a),y=k(c);if(k(e.src)===y){e.paused?e.play():e.pause();return}g?.classList.remove("hidden"),w?.classList.add("hidden"),v.textContent="0:00",S.textContent="0:00",e.src=y,e.load(),l.checked=!0,f(n.id),e.play().catch(()=>{i&&(i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon points="5 3 19 12 5 21 5 3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></polygon></svg>')})}}})});function f(n){M.forEach(o=>{if(!(o instanceof HTMLElement))return;const i=o.dataset.audioUrl,a=o.dataset.youtubeId;if(!i&&!a)return;let u=!1;if(r==="youtube"&&a&&t){const T=t.getVideoUrl();u=T?T.includes(a):!1}else if(r==="audio"&&i){const T=k(i);u=k(e.src)===T}const c=o.id===n,y=r==="youtube"?t&&t.getPlayerState()===window.YT.PlayerState.PLAYING:!e.paused,m=o.querySelector(".play-pause-icon");m&&(m.innerHTML=y&&u&&(c||n===null)?'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><rect x="6" y="4" width="4" height="16" stroke-width="2"></rect><rect x="14" y="4" width="4" height="16" stroke-width="2"></rect></svg>':'<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><polygon points="5 3 19 12 5 21 5 3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></polygon></svg>');const s=o.closest(".audio-card");s&&(s.dataset.active=y&&u&&(c||n===null)?"true":"false")})}document.addEventListener("keydown",n=>{const o=document.activeElement;if(!(o&&["INPUT","TEXTAREA"].includes(o.tagName))&&!n.altKey)switch(n.code){case"Space":n.preventDefault(),l?.click();break;case"ArrowRight":if(n.preventDefault(),r==="youtube"&&t){const i=t.getCurrentTime(),a=t.getDuration();t.seekTo(Math.min(a,i+5),!0)}else e.currentTime=Math.min(e.duration,e.currentTime+5);break;case"ArrowLeft":if(n.preventDefault(),r==="youtube"&&t){const i=t.getCurrentTime();t.seekTo(Math.max(0,i-5),!0)}else e.currentTime=Math.max(0,e.currentTime-5);break}})}document.addEventListener("DOMContentLoaded",()=>{b()});
